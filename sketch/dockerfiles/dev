FROM ubuntu:latest

RUN apt-get update && \
  apt-get install curl clang-format build-essential -y

# Install Arduino CLI
RUN mkdir /arduino-cli
WORKDIR /arduino-cli
RUN curl -fsSL https://raw.githubusercontent.com/arduino/arduino-cli/master/install.sh | sh
ENV PATH="${PATH}:/arduino-cli/bin"

# Install required platforms
RUN arduino-cli core install arduino:renesas_uno

# Compile code
COPY ArduinoMakefile /sketch/ArduinoMakefile
COPY main.cpp /sketch/main.cpp
WORKDIR /sketch
RUN make -f ArduinoMakefile
